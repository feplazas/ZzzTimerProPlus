<?xml version="1.0" encoding="utf-8"?>
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:app="http://schemas.android.com/apk/res-auto"
    xmlns:tools="http://schemas.android.com/tools"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:background="@drawable/bg_little_prince"
    tools:context=".ui.breathing.BreathingActivity">

    <!-- Toolbar fixed at top -->
    <com.google.android.material.appbar.AppBarLayout
        android:id="@+id/appBar"
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:background="@android:color/transparent"
        app:elevation="0dp">

        <com.google.android.material.appbar.MaterialToolbar
            android:id="@+id/toolbar"
            android:layout_width="match_parent"
            android:layout_height="?attr/actionBarSize"
            app:navigationIcon="@drawable/ic_arrow_back"
            app:title="@string/breathing_exercises" />

    </com.google.android.material.appbar.AppBarLayout>

    <!-- Bottom Container (Button pinned here) -->
    <LinearLayout
        android:id="@+id/bottomContainer"
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:layout_alignParentBottom="true"
        android:padding="16dp"
        android:background="@android:color/transparent">

        <com.google.android.material.button.MaterialButton
            android:id="@+id/startButton"
            android:layout_width="match_parent"
            android:layout_height="60dp"
            android:text="@string/start"
            android:textSize="18sp"
            android:textStyle="bold"
            app:cornerRadius="30dp"
            app:elevation="4dp" />
    </LinearLayout>

    <!-- Scrollable Content (between Toolbar and Bottom) -->
    <ScrollView
        android:layout_width="match_parent"
        android:layout_height="match_parent"
        android:layout_below="@id/appBar"
        android:layout_above="@id/bottomContainer"
        android:fillViewport="true">

        <LinearLayout
            android:layout_width="match_parent"
            android:layout_height="wrap_content"
            android:orientation="vertical"
            android:padding="16dp"
            android:gravity="center_horizontal">

            <!-- Animation Container (Lotus) -->
            <!-- Height fixed to ensure it takes space but doesn't push techniques too far if not needed -->
            <FrameLayout
                android:layout_width="match_parent"
                android:layout_height="320dp"
                android:gravity="center">

                <!-- The Custom Lotus View -->
                <com.felipeplazas.zzztimerpro.ui.widget.BreathingLotusView
                    android:id="@+id/lotusView"
                    android:layout_width="280dp"
                    android:layout_height="280dp"
                    android:layout_gravity="center"
                    android:visibility="gone" /> <!-- Visible when running -->

                <!-- Technique Selector (Visible when NOT running) -->
                <!-- We wrap it here so it occupies the same 'hero' space or we keep it below? 
                     User wants button visible. 
                     Let's keep Selector separate below animation area for cleaner UI? 
                     Actually, let's put animation at TOP, selector BELOW. 
                     When running, selector hides. -->
                 
                 <!-- Placeholder text or graphic when idle? Or just show the selector overlapping? -->
            </FrameLayout>

            <!-- Instructions & Timer (Center of animation usually, but we overlay text) -->
            <TextView
                android:id="@+id/instructionText"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:text="@string/ready_to_begin"
                android:textColor="#FFD700"
                android:shadowColor="#FF000000"
                android:shadowDx="0"
                android:shadowDy="4"
                android:shadowRadius="8"
                android:textSize="28sp"
                android:textStyle="bold"
                android:fontFamily="sans-serif-medium"
                android:layout_marginTop="-160dp" 
                android:elevation="10dp"/>
                
            <TextView
                android:id="@+id/timerText"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:text=""
                android:textColor="#FFD700"
                android:shadowColor="#FF000000"
                android:shadowDx="0"
                android:shadowDy="4"
                android:shadowRadius="8"
                android:textSize="50sp"
                android:textStyle="bold"
                android:elevation="10dp"/>

            <TextView
                android:id="@+id/cycleCounter"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:text=""
                android:textColor="#FFEE58"
                android:shadowColor="#80000000"
                android:shadowDx="0"
                android:shadowDy="2"
                android:shadowRadius="4"
                android:layout_marginBottom="24dp"
                android:elevation="10dp"
                android:textSize="16sp"/>

            <!-- Technique Selector -->
            <LinearLayout
                android:id="@+id/techniqueSelector"
                android:layout_width="match_parent"
                android:layout_height="wrap_content"
                android:orientation="vertical"
                android:layout_marginTop="32dp">

                <TextView
                    android:layout_width="wrap_content"
                    android:layout_height="wrap_content"
                    android:text="@string/select_technique"
                    android:textColor="?attr/colorOnSurface"
                    android:textSize="18sp"
                    android:textStyle="bold" />

                <com.google.android.material.card.MaterialCardView
                    android:id="@+id/technique478"
                    android:layout_width="match_parent"
                    android:layout_height="wrap_content"
                    android:layout_marginTop="16dp"
                    app:cardCornerRadius="12dp"
                    app:strokeColor="?attr/colorPrimary">
                    <LinearLayout android:padding="16dp" android:orientation="vertical" android:layout_width="match_parent" android:layout_height="wrap_content">
                        <TextView android:text="@string/breathing_478" android:textStyle="bold" android:textSize="16sp" android:layout_width="wrap_content" android:layout_height="wrap_content"/>
                        <TextView android:text="@string/breathing_478_instructions" android:textSize="14sp" android:layout_marginTop="4dp" android:layout_width="wrap_content" android:layout_height="wrap_content"/>
                    </LinearLayout>
                </com.google.android.material.card.MaterialCardView>

                <!-- Box Breathing -->
                <com.google.android.material.card.MaterialCardView
                    android:id="@+id/techniqueBox"
                    android:layout_width="match_parent"
                    android:layout_height="wrap_content"
                    android:layout_marginTop="12dp"
                    app:cardCornerRadius="12dp"
                    app:strokeColor="?attr/colorPrimary">
                    <LinearLayout android:padding="16dp" android:orientation="vertical" android:layout_width="match_parent" android:layout_height="wrap_content">
                        <TextView android:text="@string/breathing_box" android:textStyle="bold" android:textSize="16sp" android:layout_width="wrap_content" android:layout_height="wrap_content"/>
                        <TextView android:text="@string/breathing_box_instructions" android:textSize="14sp" android:layout_marginTop="4dp" android:layout_width="wrap_content" android:layout_height="wrap_content"/>
                    </LinearLayout>
                </com.google.android.material.card.MaterialCardView>

                <!-- Calm -->
                <com.google.android.material.card.MaterialCardView
                    android:id="@+id/techniqueCalm"
                    android:layout_width="match_parent"
                    android:layout_height="wrap_content"
                    android:layout_marginTop="12dp"
                    app:cardCornerRadius="12dp"
                    app:strokeColor="?attr/colorPrimary">
                    <LinearLayout android:padding="16dp" android:orientation="vertical" android:layout_width="match_parent" android:layout_height="wrap_content">
                        <TextView android:text="@string/breathing_calm" android:textStyle="bold" android:textSize="16sp" android:layout_width="wrap_content" android:layout_height="wrap_content"/>
                        <TextView android:text="@string/breathing_calm_instructions" android:textSize="14sp" android:layout_marginTop="4dp" android:layout_width="wrap_content" android:layout_height="wrap_content"/>
                    </LinearLayout>
                </com.google.android.material.card.MaterialCardView>
                
                <!-- Energizing -->
                <com.google.android.material.card.MaterialCardView
                    android:id="@+id/techniqueEnergizing"
                    android:layout_width="match_parent"
                    android:layout_height="wrap_content"
                    android:layout_marginTop="12dp"
                    app:cardCornerRadius="12dp"
                    app:strokeColor="?attr/colorPrimary">
                    <LinearLayout android:padding="16dp" android:orientation="vertical" android:layout_width="match_parent" android:layout_height="wrap_content">
                        <TextView android:text="@string/breathing_energizing" android:textStyle="bold" android:textSize="16sp" android:layout_width="wrap_content" android:layout_height="wrap_content"/>
                        <TextView android:text="@string/breathing_energizing_instructions" android:textSize="14sp" android:layout_marginTop="4dp" android:layout_width="wrap_content" android:layout_height="wrap_content"/>
                    </LinearLayout>
                </com.google.android.material.card.MaterialCardView>

            </LinearLayout>

        </LinearLayout>
    </ScrollView>
</RelativeLayout>

